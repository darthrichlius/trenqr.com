function Brain_HandleTrend(){var gt=this;var _trgrObj;var _bftrid;var _tgtBloc;var _ua;var _bfuElSel;var _form_sel="#newtr_form";var _iptSl="#newtr_form :input";var _errClass="notFilled";this.recoTr_url="http://127.0.0.1/korgb/ajax_test.php";this.recoTr_uq="reco_tr";this.conxTr_visit_url="http://127.0.0.1/korgb/ajax_test.php";this.conxTr_visit_uq="conx_tr_from_visit";var _f_TleAldyXsts=function(){$(".jb-ntr-itr-tle").addClass(_errClass)};var _f_NwTrArt_ReBind=function($e){$($e).find(".npost_tr_trig").click(function(e){var trid=
$(e.target).data("trid");if(KgbLib_CheckNullity(trid))return;Kxlib_PreventDefault(e);var $el=$("<span/>");$el.data("slave","brain_th-new_ml");$el.attr("id","brain_th-npost_tr");$el.data("title",$(e.target).attr("title"));$el.data("trid",trid);$el.data("isown",$(e.target).parent().parent().attr("id"));(new BrainHandler)._f_ClkOnMn($el)});$($e).find(".btmc_bot_btn").click(function(e){Kxlib_PreventDefault(e);gt.DelMyTr(e.target)});$($e).find(".action_a").focusout(function(e){if(e.target===this){Kxlib_StopPropagation(e);
$(this).parent().children(".action_foll_choices").addClass("this_hide")}});$($e).find(".action_a").click(function(e){Kxlib_PreventDefault(e);$(this).focus();if(!$(this).parent().children(".action_foll_choices").hasClass("this_hide")){$(this).parent().children(".action_foll_choices").addClass("this_hide");$(this).blur();return}$(".action_foll_choices").not(this).addClass("this_hide");$(this).parent().children(".action_foll_choices").toggleClass("this_hide")});$($e).find(".action_a").hover(function(){},
function(){});return $e};var _f_TgtRchblNAuthtic=function(bloc,id){var $o;try{$o=$(bloc)}catch(e){return}try{$o=$(bloc+" "+id);_bfuElSel=$(id)}catch(e){Kxlib_DebugVars("Can't reach BFU element !");return}return 1};var _f_BackConxtr=function(){_bfuElSel.find(".badge-conxtr-max").addClass("this_hide");if(!KgbLib_CheckNullity(_trgrObj))$(_trgrObj).data("action","rhana_conxtr");_f_Srv_DisAbo(_bfuElSel)};var _f_RhnConxtr=function(){_bfuElSel.find(".badge-conxtr-max").removeClass("this_hide");if(!KgbLib_CheckNullity(_trgrObj))$(_trgrObj).data("action",
"back_conxtr");_f_Srv_Abo(_bfuElSel)};this.DelMyTr=function(x){try{if(!KgbLib_CheckNullity(x)){var $tgr=$(x);var sl=Kxlib_ValidIdSel($tgr.data("target"));if($(sl).length){var $tar=$(sl);if($tgr.data("ans")){var i=$tar.data("trid"),s=$("<span/>");_f_Srv_DelMyTr($tar,i,s);$tar.addClass("this_hide");$(s).on("operended",function(e,d){if(KgbLib_CheckNullity(d)|!d.hasOwnProperty("o_cap")|!d.hasOwnProperty("o_pnb")|!d.hasOwnProperty("tr_nb"))return;$tar.remove();$(".jb-tmlnr-mdl-intr[data-tr="+i+"]").remove();
$(".jb-acc-spec-trnb").text(d.tr_nb);$(".jb-acc-spec-artnb").text(d.o_pnb);$(".jb-u-sp-cap-nb").text(d.o_cap);var Nty=new Notifyzing;Nty.FromUserAction("ua_del_mytr_tocome")})}else $tar.find(".brain_trch_mdl_conf").addClass("this_hide")}}else _bfuElSel.find(".brain_trch_mdl_conf").removeClass("this_hide")}catch(ex){}};var _f_RstCrTrForm=function(x){try{if(KgbLib_CheckNullity(x))return;Kxlib_ResetForm(x);$(x).find(".jb-ntr-itr-catg option:selected").removeAttr("selected");$(x).find(".jb-ntr-itr-catg option:first").attr("selected",
true);$(".jb-cat-prw").text($(x).find(".jb-ntr-itr-catg option:selected").text());$(x).find(".jb-ntr-itr-part option:first").attr("selected",true);$(".jb-part-prw").text($(x).find(".jb-ntr-itr-part option:first").text());$(x).find(".check_char_rcv").each(function(ix){var v=!KgbLib_CheckNullity($(this).data("dft"))?$(this).data("dft"):"";$(this).text(v);$(this).removeClass("red")});$(".jb-ntr-ipt").removeClass("error_field")}catch(ex){Kxlib_DebugVars([ex,ex.fileName,ex.lineNumber],true)}};var _f_Gdf=
function(){var df={"rgx_tle":/(?:(?=.*[a-z\u00c0\u00c1\u00c2\u00c3\u00c4\u00c5\u00c6\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u00e6\u1eaf\u1ea1\u1eb6\u1eb7\u1eb0\u1eb1\u1ea2\u1ea3\u00de\u00df\u00fe\u00c7\u00e7\u0110\u0111\u0189\u0256\u00d0\u00f0\u00c8\u00c9\u00ca\u00cb\u00e8\u00e9\u00ea\u00eb\u1ec1\u1ec7\u0118\u0119\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u0142\u00d2\u00d3\u00d4\u00d5\u00d6\u00d8\u0398\u00f2\u00f3\u00f4\u00f5\u00f6\u01a1\u1edf\u00f8\u00d1\u00f1\u2c63\u1d7d\u00d9\u00da\u00db\u00dc\u00f9\u00fa\u00fb\u00fc\u1ef1\u00ff\u00dd\u00fd\u0160\u017d\u017e\u017c]*).(?![\s]{5,})){20,}/i,
"rgx_tle_cn":100,"rgx_desc":/(?:(?=.*[a-z\u00c0\u00c1\u00c2\u00c3\u00c4\u00c5\u00c6\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u00e6\u1eaf\u1ea1\u1eb6\u1eb7\u1eb0\u1eb1\u1ea2\u1ea3\u00de\u00df\u00fe\u00c7\u00e7\u0110\u0111\u0189\u0256\u00d0\u00f0\u00c8\u00c9\u00ca\u00cb\u00e8\u00e9\u00ea\u00eb\u1ec1\u1ec7\u0118\u0119\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u0142\u00d2\u00d3\u00d4\u00d5\u00d6\u00d8\u0398\u00f2\u00f3\u00f4\u00f5\u00f6\u01a1\u1edf\u00f8\u00d1\u00f1\u2c63\u1d7d\u00d9\u00da\u00db\u00dc\u00f9\u00fa\u00fb\u00fc\u1ef1\u00ff\u00dd\u00fd\u0160\u017d\u017e\u017c]*).(?![\s]{5,})){20,}/i,
"rgx_desc_cn":200,"part":["_NTR_PART_PUB","_NTR_PART_PRI"]};return df};this.ChkOper=function(x){if(!_f_IsTrgrAuthentic(x))return;if($(x).hasClass("kgb_el_can_revs"))_trgrObj=x;if(!_f_TgtRchblNAuthtic(_tgtBloc,_bftrid)&&1)return;switch(_ua){case "back_conxtr":_f_BackConxtr();break;case "rhana_conxtr":_f_RhnConxtr();break;case "del_mytr":gt.DelMyTr();break;default:return;break}};var _f_CatgOnCh=function(){var v=$(".jb-ntr-itr-catg option:selected").val();if(v.toString().toUpperCase()==="_NTR_CATG_OTHER")_f_CatgList()};
var _f_CatgOnHvyChc=function(x){if(KgbLib_CheckNullity(x)|$(x).data("lk")===1)return;try{var el=$(".jb-bn-ntr-catg-chs-bdy").find("input:radio[name=bn-ntr-catg-chcs]:checked");if(!$(el).length)return;else{var v=$(el).val();if($(".jb-ntr-itr-catg option[value='"+v+"']").length)$(".jb-ntr-itr-catg option[value='"+v+"']").prop("selected",true);else{var sld=$("<option/>").attr({value:v}).text($(el).data("lbl"));$(sld).prop("selected",true);$(sld).insertBefore(".jb-ntr-itr-catg option[value=_NTR_CATG_OTHER]")}$(".jb-cat-prw").text($(el).data("lbl"));
_f_CatgSwList();$(".jb-ntr-catg-clz").addClass("this_hide")}}catch(ex){Kxlib_DebugVars([ex,ex.fileName,ex.lineNumber],true)}};var _f_CatgList=function(){$(".jb-this-catg").data("lk",1);$(".jb-ntr-catg-clz").data("lk",1);$(".jb-ntr-catg-clz").removeClass("this_hide");$(".jb-bn-ntr-catg-chs-bdy").find(".jb-bn-ntr-catg-chc-grp").remove();_f_CatgSwList(true);_f_Spinner("ntr_catg",true);var s=$("<span/>");_f_Srv_PullCatgList(s);$(s).on("datasready",function(e,d){if(KgbLib_CheckNullity(d)){$(".jb-this-catg").data("lk",
0);$(".jb-ntr-catg-clz").data("lk",0);_f_Spinner("ntr_catg");return}_f_Spinner("ntr_catg");var cn=0;$.each(d,function(i,v){var ipt=$("<input/>").attr({id:"bn-ntr-catg-chc-n"+cn,class:"bn-ntr-catg-chc-ipt",name:"bn-ntr-catg-chcs",value:i,"data-lbl":v,type:"radio"});var lbl=$("<label/>").attr({class:"bn-ntr-catg-chcs-lbl",for:"bn-ntr-catg-chc-n"+cn}).text(v);var grp=$("<div/>").attr({class:"bn-ntr-catg-chc-grp jb-bn-ntr-catg-chc-grp"}).append(ipt,lbl);$(".jb-bn-ntr-catg-chs-bdy").append(grp);++cn});
$(".jb-this-catg").data("lk",0);$(".jb-ntr-catg-clz").data("lk",0)})};var _f_NwTrd=function(x){if(KgbLib_CheckNullity(x))return;if($(x).data("lk")===1)return;$(x).data("lk",1);_f_Spinner("ntr",true);if(!_f_CheckFields()){$(x).data("lk",0);_f_Spinner("ntr");return}else{var title=$(".jb-ntr-itr-tle").val(),desc=$(".jb-ntr-itr-desc").val(),cat=$(".jb-ntr-itr-catg").val(),part=$(".jb-ntr-itr-part").val();var Pack={t:title,d:desc,c:cat,pt:part};var s=$("<span/>");_Srv_NwTrd(Pack,s,x);$(s).on("operended",
function(e,d){if(KgbLib_CheckNullity(d))return;if(!KgbLib_CheckNullity(d)&&!KgbLib_CheckNullity(d.tul)){var Nty=new Notifyzing;Nty.FromUserAction("ua_new_mytr");$(x).data("lk",0);_f_Spinner("ntr");$(".jb-f_ntr_sub_rst").click()}})}};var _f_CheckFields=function(){var fds=$(".jb-ntr-ipt"),ecn=0;$.each(fds,function(x,v){if(!$(v).data("ft"))return;if(!_f_CheckField(v))++ecn});return ecn?false:true};var _f_CheckField=function(x){if(!x|!$(x).data("ft"))return;var fd=$(x).data("ft"),v,ie=false;switch(fd.toLowerCase()){case "title":var v=
$(x).val();v=$(x).val();if(KgbLib_CheckNullity(v)){ie=true;$(x).addClass("error_field")}else if(v.length>_f_Gdf().rgx_tle_cn){ie=true;$(x).addClass("error_field")}else if(!_f_Gdf().rgx_tle.test(v)){ie=true;$(x).addClass("error_field")}else $(x).removeClass("error_field");break;case "description":var v=$(x).val();v=$(x).val();if(KgbLib_CheckNullity(v)){ie=true;$(x).addClass("error_field")}else if(v.length>_f_Gdf().rgx_desc_cn){ie=true;$(x).addClass("error_field")}else if(!_f_Gdf().rgx_desc.test(v)){ie=
true;$(x).addClass("error_field")}else $(x).removeClass("error_field");break;case "category":break;case "participation":v=$(".jb-ntr-itr-part option:selected").val();if(KgbLib_CheckNullity(v)){ie=true;$(x).addClass("error_field")}else if($.inArray(v,_f_Gdf().part)===-1){ie=true;$(x).addClass("error_field")}else $(x).removeClass("error_field");break;default:return;break}return ie?false:true};var _f_IsTrgrAuthentic=function(x){if(KgbLib_CheckNullity($(x).data("target")))return;else _bftrid=Kxlib_ValidIdSel($(x).data("target"));
if(KgbLib_CheckNullity($(x).data("tarbloc")))return;else _tgtBloc=Kxlib_ValidIdSel($(x).data("tarbloc"));if(KgbLib_CheckNullity($(x).data("action")))return;else _ua=$(x).data("action");return true};var _Ax_DisAbo=Kxlib_GetAjaxRules("TMLNR_BN_DISABO",Kxlib_GetCurUserPropIfExist().upsd);var _f_Srv_DisAbo=function(x){if(KgbLib_CheckNullity(x)|KgbLib_CheckNullity($(x).data("trid")))return;var i=$(x).data("trid");var onsuccess=function(datas){try{if(!KgbLib_CheckNullity(datas)){datas=JSON.parse(datas);
if(!KgbLib_CheckNullity(datas.err)){if(Kxlib_AjaxIsErrVolatile(datas.err))switch(datas.err){case "__ERR_VOL_USER_GONE":case "__ERR_VOL_ACC_GONE":case "__ERR_VOL_CU_GONE":Kxlib_HandleCurrUserGone();break;case "__ERR_VOL_DENY":case "__ERR_VOL_DENY_AKX":Kxlib_AJAX_HandleDeny();return;break;default:return;break}return}else if(!KgbLib_CheckNullity(datas.return)){$(_bftrid).data("isfolw","0");var rds=[datas.return];$(s).trigger("datasready",rds)}}else return}catch(e){Kxlib_AJAX_HandleFailed("ERR_COM_AJAX_FAIL_TECH");
return}};var onerror=function(a,b,c){Kxlib_AjaxGblOnErr(a,b)};var toSend={"urqid":_Ax_DisAbo.urqid,"datas":{"tr_id":i}};Kx_XHR_Send(toSend,null,null,onsuccess,onerror,{type:"post",url:_Ax_DisAbo.url,wcrdtl:_Ax_DisAbo.wcrdtl})};var _Ax_DelMyTr=Kxlib_GetAjaxRules("TMLNR_DEL_MyTR",Kxlib_GetCurUserPropIfExist().upsd);var _f_Srv_DelMyTr=function(de,i,s){if(KgbLib_CheckNullity(de)|KgbLib_CheckNullity(i)|KgbLib_CheckNullity(s))return;var onsuccess=function(d){try{if(!KgbLib_CheckNullity(d))d=JSON.parse(d);
else return;if(!KgbLib_CheckNullity(d.err)){if(Kxlib_AjaxIsErrVolatile(d.err))switch(d.err){case "__ERR_VOL_CU_GONE":Kxlib_HandleCurrUserGone();break;case "__ERR_VOL_TR_GONE":$(de).remove();return;break;case "__ERR_VOL_DENY":case "__ERR_VOL_DENY_AKX":case "__ERR_VOL_FAILED":return;break;default:return;break}return}else if(!KgbLib_CheckNullity(d.return)){var rds=[d.return];$(s).trigger("operended",rds)}}catch(e){return}};var onerror=function(a,b,c){Kxlib_AjaxGblOnErr(a,b);return};var curl=document.URL;
var toSend={"urqid":_Ax_DelMyTr.urqid,"datas":{"i":i,"cl":curl}};Kx_XHR_Send(toSend,null,null,onsuccess,onerror,{type:"post",url:_Ax_DelMyTr.url,wcrdtl:_Ax_DelMyTr.wcrdtl})};var _Ax_NewTrend=Kxlib_GetAjaxRules("TMLNR_BRAIN_NEWTREND",Kxlib_GetCurUserPropIfExist().upsd);var _Srv_NwTrd=function(o,s,x){if(KgbLib_CheckNullity(o)|KgbLib_CheckNullity(s)|KgbLib_CheckNullity(x)){$(x).data("lk",0);_f_Spinner("ntr");return}var os=function(d){try{if(!KgbLib_CheckNullity(d))d=JSON.parse(d);else return;if(!KgbLib_CheckNullity(d.err)){$(x).data("lk",
0);_f_Spinner("ntr");if(Kxlib_AjaxIsErrVolatile(d.err))switch(d.err){case "__ERR_VOL_U_G":case "__ERR_VOL_U_GONE":case "__ERR_VOL_CU_GONE":case "__ERR_VOL_ACC_GONE":Kxlib_HandleCurrUserGone();break;case "__ERR_VOL_DENY":case "__ERR_VOL_DENY_AKX":case "__ERR_VOL_FAILED":return;break;case "__ERR_VOL_WRG_DATAS":Kxlib_AJAX_HandleFailed();return;break;default:return;break}return}else if(!KgbLib_CheckNullity(d.return)){var rds=[d.return];$(s).trigger("operended",rds)}}catch(ex){$(x).data("lk",0);_f_Spinner("ntr");
Kxlib_AJAX_HandleFailed("ERR_COM_AJAX_FAIL_TECH");return}};var oe=function(){$(x).data("lk",0);_f_Spinner("ntr");return};var curl=document.URL;var toSend={"urqid":_Ax_NewTrend.urqid,"datas":{"t":o.t,"d":o.d,"c":o.c,"pt":o.pt,"cl":curl}};Kx_XHR_Send(toSend,null,null,os,oe,{type:"post",url:_Ax_NewTrend.url,wcrdtl:_Ax_NewTrend.wcrdtl})};var _Ax_Abo=Kxlib_GetAjaxRules("TMLNR_BN_ABO",Kxlib_GetCurUserPropIfExist().upsd);var _f_Srv_Abo=function(x){if(KgbLib_CheckNullity(x)|KgbLib_CheckNullity($(x).data("trid")))return;
var i=$(x).data("trid");var onsuccess=function(datas){try{if(!KgbLib_CheckNullity(datas)){datas=JSON.parse(datas);if(!KgbLib_CheckNullity(datas.err)){if(Kxlib_AjaxIsErrVolatile(datas.err))switch(datas.err){case "__ERR_VOL_USER_GONE":case "__ERR_VOL_ACC_GONE":case "__ERR_VOL_CU_GONE":Kxlib_HandleCurrUserGone();break;case "__ERR_VOL_DENY":case "__ERR_VOL_DENY_AKX":Kxlib_AJAX_HandleDeny();return;break;default:return;break}return}else if(!KgbLib_CheckNullity(datas.return));}else return}catch(e){Kxlib_AJAX_HandleFailed("ERR_COM_AJAX_FAIL_TECH");
return}};var onerror=function(a,b,c){Kxlib_AjaxGblOnErr(a,b)};var toSend={"urqid":_Ax_Abo.urqid,"datas":{"tr_id":i}};Kx_XHR_Send(toSend,null,null,onsuccess,onerror,{type:"post",url:_Ax_Abo.url,wcrdtl:_Ax_Abo.wcrdtl})};var _Ax_PullCatgList=Kxlib_GetAjaxRules("TMLNR_BRAIN_PLCATG",Kxlib_GetCurUserPropIfExist().upsd);var _f_Srv_PullCatgList=function(s){if(KgbLib_CheckNullity(s)){$(".jb-this-catg").data("lk",0);$(".jb-ntr-catg-clz").data("lk",0);_f_Spinner("ntr_catg");return}var onsuccess=function(datas){try{if(!KgbLib_CheckNullity(datas)){datas=
JSON.parse(datas);if(!KgbLib_CheckNullity(datas.err)){if(Kxlib_AjaxIsErrVolatile(datas.err)){$(".jb-this-catg").data("lk",0);$(".jb-ntr-catg-clz").data("lk",0);_f_Spinner("ntr_catg");switch(datas.err){case "__ERR_VOL_USER_GONE":case "__ERR_VOL_ACC_GONE":case "__ERR_VOL_CU_GONE":Kxlib_HandleCurrUserGone();break;case "__ERR_VOL_DENY":case "__ERR_VOL_DENY_AKX":Kxlib_AJAX_HandleDeny();return;break;default:return;break}}return}else if(!KgbLib_CheckNullity(datas.return)){var rds=[datas.return];$(s).trigger("datasready",
rds)}}else return}catch(e){Kxlib_AJAX_HandleFailed("ERR_COM_AJAX_FAIL_TECH");return}};var onerror=function(a,b,c){Kxlib_AjaxGblOnErr(a,b)};var curl=document.URL;var toSend={"urqid":_Ax_PullCatgList.urqid,"datas":{"curl":curl}};Kx_XHR_Send(toSend,null,null,onsuccess,onerror,{type:"post",url:_Ax_PullCatgList.url,wcrdtl:_Ax_PullCatgList.wcrdtl})};var _f_ChgOnSelect=function(x){if(KgbLib_CheckNullity(x))return;var s=Kxlib_ValidIdSel($(x).attr("id")+" option:selected");var v=$(s).text(),pv=Kxlib_ValidIdSel($(x).data("preview"));
$(pv).html(v)};var _f_Spinner=function(scp,sw){if(KgbLib_CheckNullity(scp))return;var s;switch(scp.toLowerCase()){case "ntr":s=".jb-nwtr-trg-spnr";break;case "ntr_catg":s=".jb-bn-ntr-catg-chs-spnr";break;default:return}if(sw)$(s).removeClass("this_hide");else $(s).addClass("this_hide")};var _f_CatgSwList=function(sw){if(sw){$(".jb-bn-ntr-catg-chs-sprt").removeClass("this_hide");$(".jb-bn-newtr-mx").addClass("this_hide")}else{$(".jb-bn-ntr-catg-chs-sprt").addClass("this_hide");$(".jb-bn-newtr-mx").removeClass("this_hide")}};
$(_iptSl).blur(function(){if($(this).val()!=="")$(this).removeClass(_errClass)});$(".jb-crt-trd-tgr").click(function(e){Kxlib_PreventDefault(e);_f_NwTrd(this)});$("#newtr_form select").change(function(e){_f_ChgOnSelect(this)});$("#reset_tr_btn").change(function(){var sl=Kxlib_ValidIdSel($(this).data("form"));$(sl).each(function(){this.reset()})});$(".btmc_bot_btn").click(function(e){Kxlib_PreventDefault(e);gt.DelMyTr(this)});$(".jb-f_ntr_sub_rst").click(function(e){Kxlib_PreventDefault(e);var t=Kxlib_ValidIdSel($(this).data("target"));
_f_RstCrTrForm(t)});$(".jb-ntr-itr-catg").change(function(){_f_CatgOnCh()});$(".jb-this-catg").click(function(e){Kxlib_PreventDefault(e);_f_CatgOnHvyChc(this)});$(".jb-ntr-catg-clz").click(function(e){Kxlib_PreventDefault(e);_f_CatgSwList();$(".jb-ntr-catg-clz").addClass("this_hide")})}new Brain_HandleTrend;function TrOpe_Receiver(){this.Routeur=function(th){if(KgbLib_CheckNullity(th))return;var _Obj=new Brain_HandleTrend;_Obj.ChkOper(th)}};
