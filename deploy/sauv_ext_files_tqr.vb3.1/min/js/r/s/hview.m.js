(function(){var _xhr_hview_srh,_xhr_hview_gtmr;var _f_Gdf=function(){var ds={"hsh_max_ln":50,"cnbp":10};return ds};var _f_Init=function(){try{$(".jb-tqr-hview-screen").css({"min-height":$(window).height()+"px"});if(!KgbLib_CheckNullity($(".jb-tqr-hview-c-h-h-ipt").data("input")))_f_LckIpt(true);_f_HvSrh("init")}catch(ex){Kxlib_DebugVars([ex,ex.fileName,ex.lineNumber],true)}};var _f_Action=function(x,a){try{if(KgbLib_CheckNullity(x)|(KgbLib_CheckNullity(a)&&KgbLib_CheckNullity($(x).data("action"))))return;
var _a=!KgbLib_CheckNullity(a)?a:$(x).data("action");switch(_a){case "search":case "get_more":_f_HvSrh(_a);break;case "open-in-vwr":_f_OpenVwr(x,a);break;default:break}}catch(ex){Kxlib_DebugVars([ex,ex.fileName,ex.lineNumber],true)}};var _f_HvSrh=function(a){try{if(KgbLib_CheckNullity(a))return;var hs,dr,pvi,pvt;switch(a){case "init":case "search":var t__=$(".jb-tqr-hview-c-h-h-ipt").val();t__=_f_SrhStrValid(t__);if(!t__)return;hs=t__;if(!KgbLib_CheckNullity(_xhr_hview_srh))_xhr_hview_srh.abort();
if(!KgbLib_CheckNullity(_xhr_hview_gtmr))_xhr_hview_gtmr.abort();$(".jb-tqr-hview-art-bmx").remove();_f_LckIpt(true);$(".jb-tqr-hview-c-h-h-x-mx").text("");break;case "get_more":if($(".jb-tqr-hview-ctr-l-l-EOF-none").data("EOF")===1)return;if($(".jb-tqr-hview-art-bmx").length<_f_Gdf().cnbp)return;var t__=$(".jb-tqr-hview-c-h-h-ipt").data("input");t__=_f_SrhStrValid(t__);if(!t__)return;hs=t__;if(!KgbLib_CheckNullity(_xhr_hview_srh)){if(!KgbLib_CheckNullity(_xhr_hview_gtmr))_xhr_hview_gtmr.abort();
return}else if(!KgbLib_CheckNullity(_xhr_hview_gtmr))return;dr="BTM";pvi=$(".jb-tqr-hview-art-bmx:last").data("hid");pvt=$(".jb-tqr-hview-art-bmx:last").data("htm");break;case "auto":break;default:return}_f_None();_f_Spnr(true,a);var tos={"hs":hs,"dr":dr?dr:"FST","pvi":pvi?pvi:null,"pvt":pvt?pvt:null};var s=$("<span/>");_f_Srv_HvSrh(tos.hs,tos.dr,tos.pvi,tos.pvt,a,s);$(s).on("datasready",function(e,ds){if(KgbLib_CheckNullity(ds))return ds;if(!KgbLib_CheckNullity(ds.hd))_f_HDesc(ds.hd);else _f_HDesc();
$(".jb-tqr-hview-c-h-h-hlib-mx").attr("title",hs).text("#"+hs);$(".jb-tqr-hview-c-h-h-ipt").data("input",hs);if(!KgbLib_CheckNullity(ds.ds))_f_AddGblDs(ds.ds,a,tos.dr);else _f_None(true);var stateObj={};var prmlk_path="/hview/q=".concat(tos.hs,"&src=hash");window.history.replaceState(stateObj,"",prmlk_path);_f_LckIpt();if($.inArray(a,["search","init"])!==-1)_xhr_hview_srh=null;else if(a==="get_more")_xhr_hview_gtmr=null});$(s).on("operended",function(e,ds){if(ds&&ds.hd)_f_HDesc(ds.hd);else _f_HDesc();
$(".jb-tqr-hview-c-h-h-hlib-mx").attr("title",hs).text("#"+hs);if($.inArray(a,["search","init"])!==-1){_f_Spnr(null,"search");_f_None(true)}else if(a==="get_more")$(".jb-tqr-hview-ctr-l-l-EOF-none").data("EOF",1);var stateObj={};var prmlk_path="/hview/q=".concat(tos.hs,"&src=hash");window.history.replaceState(stateObj,"",prmlk_path);_f_LckIpt();if($.inArray(a,["search","init"])!==-1)_xhr_hview_srh=null;else if(a==="get_more")_xhr_hview_gtmr=null})}catch(ex){Kxlib_DebugVars([ex,ex.fileName,ex.lineNumber],
true)}};var _f_SrhStrValid=function(hs){try{if(KgbLib_CheckNullity(hs))return;var ok=true;if(!(typeof hs==="string"&&hs.length))return;hs=hs.trim();hs=hs.charAt(0)==="#"?hs.slice(1):hs;var rgx=/[^a-z\d_\u00c0\u00c1\u00c2\u00c3\u00c4\u00c5\u00c6\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u00e6\u1eaf\u1ea1\u1eb6\u1eb7\u1eb0\u1eb1\u1ea2\u1ea3\u00de\u00df\u00fe\u00c7\u00e7\u0110\u0111\u0189\u0256\u00d0\u00f0\u00c8\u00c9\u00ca\u00cb\u00e8\u00e9\u00ea\u00eb\u1ec1\u1ec7\u0118\u0119\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u0142\u00d2\u00d3\u00d4\u00d5\u00d6\u00d8\u0398\u00f2\u00f3\u00f4\u00f5\u00f6\u01a1\u1edf\u00f8\u00d1\u00f1\u2c63\u1d7d\u00d9\u00da\u00db\u00dc\u00f9\u00fa\u00fb\u00fc\u1ef1\u00ff\u00dd\u00fd\u0160\u017d\u017e\u017c]/i;
if(rgx.test(hs)){alert("Seulement des Lettres, Chiffres, et '_' ");ok=false}if(hs.length>_f_Gdf().hsh_max_ln){alert("Pas plus de "+_f_Gdf().hsh_max_ln+" carac\u00e8tres");ok=false}return ok?hs:false}catch(ex){Kxlib_DebugVars([ex,ex.fileName,ex.lineNumber],true)}};var _f_AddGblDs=function(ds,a,dr){try{if(KgbLib_CheckNullity(ds)|KgbLib_CheckNullity(a)|KgbLib_CheckNullity(dr))return;if($.inArray(dr,["FST","TOP","BTM"])===-1)return;_f_None();_f_Spnr(null,a);$.each(ds.g,function(x,st){if($(".jb-tqr-hview-art-bmx[data-cnid='"+
st.cnid+"'][data-ctp='"+st.type+"']").length){Kxlib_DebugVars(["Exists > (TYPE) : "+st.type+"; (ITEM) : "+st.cnid]);return true}var cm;if($.inArray(st.type,["AIML","AITR"])!==-1)cm=_f_PprMdlPho(st,ds.c[st.type][st.cnid]);else if($.inArray(st.type,["TST"])!==-1){cm=_f_PprMdlTst(st,ds.c[st.type][st.cnid]);cm=_f_RbdMdlTst(cm)}if(dr==="TOP")$(cm).hide().prependTo(".jb-tqr-hview-ctr-l-list-mx").fadeIn();else $(cm).hide().appendTo(".jb-tqr-hview-ctr-l-list-mx").fadeIn()})}catch(ex){Kxlib_DebugVars([ex,
ex.fileName,ex.lineNumber],true)}};var _f_OpenVwr=function(x,a){try{if(KgbLib_CheckNullity(x)|KgbLib_CheckNullity(a))return;if(require.specified("r/csam/tkbvwr.csam"))_VWR.open({model:"AJCA-HVIEW",trigger:x,action:a});else require(["r/csam/tkbvwr.csam"],function(TbkVwr){_VWR=new TbkVwr;_VWR.open({model:"AJCA-HVIEW",trigger:x,action:a})})}catch(ex){Kxlib_DebugVars([ex,ex.fileName,ex.lineNumber],true)}};var _Ax_HvSrh=Kxlib_GetAjaxRules("TQR_HVIEW_GDS");var _f_Srv_HvSrh=function(hs,dr,pvi,pvt,a,s){if(KgbLib_CheckNullity(hs)|
KgbLib_CheckNullity(a)|KgbLib_CheckNullity(s))return;var onsuccess=function(datas){try{if(!KgbLib_CheckNullity(datas))datas=JSON.parse(datas);else{if($.inArray(a,["search","init"])!==-1)_xhr_hview_srh=null;else if(a==="get_more")_xhr_hview_gtmr=null;_f_LckIpt();return}if(!KgbLib_CheckNullity(datas.err)){if($.inArray(a,["search","init"])!==-1)_xhr_hview_srh=null;else if(a==="get_more")_xhr_hview_gtmr=null;_f_LckIpt();if(Kxlib_AjaxIsErrVolatile(datas.err))switch(datas.err){case "__ERR_VOL_ACC_GONE":case "__ERR_VOL_USER_GONE":case "__ERR_VOL_U_G":case "__ERR_VOL_CU_GONE":Kxlib_HandleCurrUserGone();
break;case "__ERR_VOL_FAILED":Kxlib_AJAX_HandleFailed();break;case "__ERR_VOL_DENY":case "__ERR_VOL_DENY_AKX":break;default:Kxlib_AJAX_HandleFailed();break}return}else if(!KgbLib_CheckNullity(datas.return)&&(!KgbLib_CheckNullity(datas.return.ds)&&!KgbLib_CheckNullity(datas.return.ds.g)&&!KgbLib_CheckNullity(datas.return.ds.c))){var ds=[datas.return];$(s).trigger("datasready",ds)}else if(!KgbLib_CheckNullity(datas.return.hd)&&datas.return.hd){var ds=[datas.return];$(s).trigger("operended",ds);return}else{$(s).trigger("operended");
return}}catch(ex){if($.inArray(a,["search","init"])!==-1)_xhr_hview_srh=null;else if(a==="get_more")_xhr_hview_gtmr=null;_f_LckIpt();Kxlib_AJAX_HandleFailed("ERR_COM_AJAX_FAIL_TECH");return}};var onerror=function(a,b,c){Kxlib_AjaxGblOnErr(a,b);Kxlib_AJAX_HandleFailed("ERR_COM_AJAX_FAIL_TECH");return};var curl=document.URL;var toSend={"urqid":_Ax_HvSrh.urqid,"datas":{"hs":hs,"dr":dr,"pvi":pvi,"pvt":pvt,"cu":curl}};var _xhr=Kx_XHR_Send(toSend,null,null,onsuccess,onerror,{type:"post",url:_Ax_HvSrh.url,
wcrdtl:_Ax_HvSrh.wcrdtl});if($.inArray(a,["search","init"])!==-1)_xhr_hview_srh=_xhr;else if(a==="get_more")_xhr_hview_gtmr=_xhr};var _f_LckIpt=function(y){try{if(y)$(".jb-tqr-hview-c-h-h-ipt").attr("disabled","disabled");else $(".jb-tqr-hview-c-h-h-ipt").removeAttr("disabled")}catch(ex){Kxlib_DebugVars([ex,ex.fileName,ex.lineNumber],true)}};var _f_None=function(sh){try{if(sh)$(".jb-tqr-hview-ctr-l-l-none").removeClass("this_hide");else $(".jb-tqr-hview-ctr-l-l-none").addClass("this_hide")}catch(ex){Kxlib_DebugVars([ex,
ex.fileName,ex.lineNumber],true)}};var _f_HDesc=function(d){try{if(d){$(".jb-tqr-hview-c-h-h-x-mx").html(d);$(".jb-tqr-hview-c-h-h-x-bmx").removeClass("this_hide")}else $(".jb-tqr-hview-c-h-h-x-bmx").addClass("this_hide")}catch(ex){Kxlib_DebugVars([ex,ex.fileName,ex.lineNumber],true)}};var _f_Spnr=function(sh,scp){try{if(KgbLib_CheckNullity(scp))return;var mx;switch(scp){case "init":case "search":mx=$(".jb-tqr-hview-ctr-l-l-loadr");break;case "get_more":mx=null;break;default:return}if(!$(mx).length)return;
else if(sh)$(mx).removeClass("this_hide");else $(mx).addClass("this_hide")}catch(ex){Kxlib_DebugVars([ex,ex.fileName,ex.lineNumber],true)}};var _f_PprMdlPho=function(hs,ds){try{if(KgbLib_CheckNullity(hs)|KgbLib_CheckNullity(ds))return;var cm='<article class="tqr-hview-art-bmx jb-tqr-hview-art-bmx" data-type="photo" data-hid="" data-cnid="" data-htm="" data-ctp="" data-ajcache="">';cm+='<div class="tqr-hview-art-pho-top">';cm+='<a class="tqr-hview-a-pho-a jb-tqr-hview-a-pho-a" href="">';cm+='<img class="tqr-hview-a-pho-i jb-tqr-hview-a-pho-i" width="600px" height="600px" src="" alt="" />';
cm+='<span class="tqr-hview-a-pho-fd jb-tqr-hview-a-pho-fd"></span>';cm+="<span class='css-tgpsy kxlib_tgspy tqr-hview' data-type=\"photo\" data-tgs-crd='"+ds.atime+"' data-tgs-dd-atn='' data-tgs-dd-uut=''>";cm+="<span class='tgs-frm'></span>";cm+="<span class='tgs-val'></span>";cm+="<span class='tgs-uni'></span>";cm+="</span>";cm+='<span class="tqr-hview-a-pho-stats">';cm+='<span class="tqr-hview-a-pho-s-mx jb-tqr-hview-a-pho-s-mx" data-type="eval">';cm+='<span class="tqr-hview-a-pho-s-nb jb-tqr-hview-a-pho-s-nb" data-type="eval"></span>';
cm+="</span>";cm+='<span class="tqr-hview-a-pho-s-mx jb-tqr-hview-a-pho-s-mx" data-type="react">';cm+='<span class="tqr-hview-a-pho-s-nb jb-tqr-hview-a-pho-s-nb" data-type="react"></span>';cm+='<span class="tqr-hview-a-pho-s-lg" data-type="react" style=" background: url(\''+Kxlib_GetExtFileURL("sys_url_img","r/r3.png")+"') no-repeat; background-size: 100%;\"></span>";cm+="</span>";cm+="</span>";cm+="</a>";cm+="</div>";cm+='<div class="tqr-hview-art-pho-btm">';cm+='<div class="tqr-hview-a-pho-b-trtle-mx jb-tqr-hview-a-pho-b-trtle-mx">';
cm+='<a class="tqr-hview-a-pho-b-trtle jb-tqr-hview-a-pho-b-trtle" title=""</a>';cm+="</div>";cm+='<div class="tqr-hview-a-pho-b-dsc-mx">';cm+='<a class="tqr-hview-a-pho-b-d-o jb-tqr-hview-a-pho-b-d-o" href=""></a>';cm+='<span class="tqr-hview-a-pho-b-d-dsc jb-tqr-hview-a-pho-b-d-dsc"></span>';cm+="</div>";cm+="</div>";cm+="</article>";cm=$.parseHTML(cm);$(cm).data("ajcache",JSON.stringify(ds)).attr("data-ajcache",JSON.stringify(ds));$(cm).data("hid",hs.hid).data("cnid",hs.cnid).data("htm",hs.time).data("ctp",
hs.type);$(cm).attr({"data-hid":hs.hid,"data-cnid":hs.cnid,"data-htm":hs.time,"data-ctp":hs.type});$(cm).find(".jb-tqr-hview-a-pho-a").attr({href:ds.aprmlk});$(cm).find(".jb-tqr-hview-a-pho-i").attr({"src":ds.apic,"alt":Kxlib_Decode_After_Encode(ds.adesc)});var evals=ds.hasOwnProperty("aevals")&&ds.aevals&&$.isArray(ds.aevals)&&ds.aevals.length===4?ds.aevals[3]:0;$(cm).find(".jb-tqr-hview-a-pho-s-nb[data-type='eval']").text(evals);$(cm).find(".jb-tqr-hview-a-pho-s-nb[data-type='react']").text(ds.arnb);
if(ds.hasOwnProperty("teid")&&ds.teid)$(cm).find(".jb-tqr-hview-a-pho-b-trtle").attr({href:ds.thref,title:Kxlib_Decode_After_Encode(ds.ttle)}).text(Kxlib_Decode_After_Encode(ds.ttle));else $(cm).find(".jb-tqr-hview-a-pho-b-trtle-mx").remove();$(cm).find(".jb-tqr-hview-a-pho-b-d-o").attr({href:"/".concat(ds.aopsd),title:ds.aofn.concat(" (@").concat(ds.aopsd).concat(")")}).text("@".concat(ds.aopsd));var atxt=ds.adesc;atxt=$("<div/>").html(atxt).text();var ajca_o,ajca=""+$(cm).data("ajcache")+"";ajca_o=
typeof $(cm).data("ajcache")==="object"?$(cm).data("ajcache"):JSON.parse(ajca);var ustgs=ajca_o.ustgs;var hashs=ajca_o.hashs;var rtxt=Kxlib_TextEmpow(atxt,ustgs,hashs,null,{emoji:{"size":36,"size_css":18,"position_y":3}});$(cm).find(".jb-tqr-hview-a-pho-b-d-dsc").text("").append(rtxt);return cm}catch(ex){Kxlib_DebugVars([ex,ex.fileNcme,ex.lineNumber],true)}};var _f_RbdMdlTst=function(am){try{if(KgbLib_CheckNullity(am))return;$(am).click(function(e){Kxlib_PreventDefault(e);_f_Action(this,"open-in-vwr")});
$(am).children().click(function(e){if($(e.target).is("a")|$(e.target).parent().is("a"))Kxlib_StopPropagation(e)});$(am).hover(function(e){var bmx=$(this).is(".jb-tqr-hview-art-bmx")?$(this):$(x).closest(".jb-tqr-hview-art-bmx");$(bmx).addClass("cstm-hvr")},function(){var bmx=$(this).is(".jb-tqr-hview-art-bmx")?$(this):$(x).closest(".jb-tqr-hview-art-bmx");$(bmx).removeClass("cstm-hvr")});return am}catch(ex){Kxlib_DebugVars([ex,ex.fileNcme,ex.lineNumber],true)}};var _f_PprMdlTst=function(hs,ds){try{if(KgbLib_CheckNullity(hs)|
KgbLib_CheckNullity(ds))return;var cm='<article class="tqr-hview-art-bmx jb-tqr-hview-art-bmx" data-type="testy" data-hid="" data-cnid="" data-htm="" data-ctp="" data-ajcache="" data-atype="hview" >';cm+='<div class="tqr-hview-art-tst-left">';cm+='<div class="tqr-hview-a-tst-o-top">';cm+='<a class="tqr-hview-a-tst-o-a jb-tqr-hview-a-tst-o-a" href="">';cm+='<img class="tqr-hview-a-tst-o-i jb-tqr-hview-a-tst-o-i" src="" height="65" alt="65" alt=""/>';cm+='<span class="tqr-hview-a-tst-o-fd"></span>';
cm+="</a>";cm+="</div>";cm+='<div class="tqr-hview-a-tst-o-btm">';cm+='<a class="tqr-hview-a-tst-o-psd jb-tqr-hview-a-tst-o-psd" href=""></a>';cm+='<span class="tqr-hview-a-tst-o-fn jb-tqr-hview-a-tst-o-fn"></span>';cm+="</div>";cm+="</div>";cm+='<div class="tqr-hview-art-tst-right">';cm+='<div class="tqr-hview-a-tst-r-top">';cm+='<a class="tqr-hview-a-tst-tgt-a jb-tqr-hview-a-tst-tgt-a" href=""></a>';cm+="<span class='css-tgpsy kxlib_tgspy tqr-hview' data-type=\"testy\" data-tgs-crd='"+ds.tm+"' data-tgs-dd-atn='' data-tgs-dd-uut=''>";
cm+="<span class='tgs-frm'></span>";cm+="<span class='tgs-val'></span>";cm+="<span class='tgs-uni'></span>";cm+="</span>";cm+="</div>";cm+='<div class="tqr-hview-a-tst-r-btm">';cm+='<div class="tqr-hview-a-tst-m jb-tqr-hview-a-tst-m"></div>';cm+="</div>";cm+="</div>";cm+="</article>";cm=$.parseHTML(cm);$(cm).data("ajcache",JSON.stringify(ds));$(cm).data("hid",hs.hid).data("cnid",hs.cnid).data("htm",hs.time).data("ctp",hs.type);$(cm).attr({"data-hid":hs.hid,"data-cnid":hs.cnid,"data-htm":hs.time,"data-ctp":hs.type});
$(cm).find(".jb-tqr-hview-a-tst-o-a").attr({href:"/"+ds.au.opsd});$(cm).find(".jb-tqr-hview-a-tst-o-i").attr({"src":ds.au.oppic,"alt":ds.au.ofn.concat(" (@").concat(ds.au.opsd).concat(")")});$(cm).find(".jb-tqr-hview-a-tst-o-psd").attr({href:"/"+ds.au.opsd}).text("@".concat(ds.au.opsd));$(cm).find(".jb-tqr-hview-a-tst-o-fn").text(ds.au.ofn);if(ds.au.oid!==ds.tg.oid)$(cm).find(".jb-tqr-hview-a-tst-tgt-a").attr({href:"/"+ds.tg.opsd}).text("@".concat(ds.tg.opsd));else $(cm).find(".jb-tqr-hview-a-tst-tgt-a").remove();
var atxt=ds.m;atxt=$("<div/>").html(atxt).text();var ajca_o,ajca=""+$(cm).data("ajcache")+"";ajca_o=typeof $(cm).data("ajcache")==="object"?$(cm).data("ajcache"):JSON.parse(ajca);var ustgs=ajca_o.ustgs;var hashs=ajca_o.hashs;var rtxt=Kxlib_TextEmpow(atxt,ustgs,hashs,null,{"ena_inner_link":{"all":false,"only":"fksa"},emoji:{"size":36,"size_css":20,"position_y":3}});$(cm).find(".jb-tqr-hview-a-tst-m").text("").append(rtxt);return cm}catch(ex){Kxlib_DebugVars([ex,ex.fileName,ex.lineNumber],true)}};$(".jb-tqr-hview-c-h-h-ipt").keypress(function(e){if(e.which&&
e.which===13||e.keyCode&&e.keyCode===13){Kxlib_PreventDefault(e);_f_Action(this,"search")}});$(".jb-tqr-snifr-wdw-scltp").on("my-scroll",function(e,std){var nwstd=std+$(window).height();if($(".jb-tqr-hview-art-bmx").length&&nwstd>=$(document).height()*.8)_f_Action(this,"get_more")});_f_Init()})();
